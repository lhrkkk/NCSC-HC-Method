# 多肽构象系综评价+聚类程序

## 功能
    读取.csv或.xls格式的多肽二面角数据。
    计算并输出该系综的归一化构象空间覆盖度以及(1-基尼系数)，前者反映构象系综的多样性，后者反映分布均匀度。两者的值均与构象系综质量正相关。
    绘制该系综的能量“态密度图”。
    对构象系综进行聚类，以.csv格式输出聚类结果，以及对聚类结果进行可视化分析。

## 依赖环境

### python 版本
    python 3

### 第三方库
    numpy 1.19.2
    sklearn 0.24.0
    matplotlib 3.3.3

## 使用方法
    命令行调用
    ```
    python eval_and_cluster.py [-h] [-n N] [-s S] [-e E] [-i <filename>] [-o <filename>] [--cluster] [--sidechain] [--show] [--stg]
    ```

## 参数解释
    -h  查看帮助
    -n  当前多肽构象系综所含氨基酸的数目。
    -s  当前多肽的氨基酸序列，氨基酸用单个大写字母缩写表示。如“甘氨酸-丙氨酸”二肽缩写为“VA”。
    -e  构象能量截断。能量高于此值的构象将不被读取，并不参与后续计算。
    -i  .csv或.xls格式的多肽二面角数据文件路径。
    -o  聚类结果输出文件路径。默认为当前目录。文件名为输入文件后加上“_clusteropt”。
    --cluster   是否进行构象聚类算法。默认为不进行。
    --sidechain 聚类算法是否考虑侧链二面角。默认为不考虑。
    --show      是否进行聚类结果可视化。默认为不进行。
    --stg       是否绘制态密度图，默认为不绘制。

## 输入文件格式

### xls格式
    | 构象文件名 | 以空格分隔的构象二面角(°) | 构象能量(kcal/mol)|
    |----------:|------------------------:|-----------------:|
    |  12345.xyz|   -180.0 45.0 90.0 135.0|             4.321|
    |  54321.xyz|   120.0 120.0 90.0 -45.0|             1.234|

### csv格式
    构象文件名,以空格分隔的构象二面角(°),构象能量(kcal/mol)
    12345.xyz,-180.0 45.0 90.0 135.0,4.321
    54321.xyz,120.0 120.0 90.0 -45.0,1.234