# 多肽构象系综评价+聚类程序

## 功能
    读取.csv或.xls格式的多肽二面角数据。
    计算并输出该系综的归一化构象空间覆盖度以及1-基尼系数。
    绘制该系综的能量“态密度图”。
    对构象系综进行聚类，以.csv格式输出聚类结果，以及对聚类结果进行可视化。

## 依赖环境

### python 版本
    python 3

### 第三方库
    numpy 1.19.2
    sklearn 0.24.0
    matplotlib 3.3.3

## 使用方法
    命令行调用：

    python eval_and_cluster.py [-h] [-n N] [-s S] [-e E] [-ncfm N] [-i <filename>] [-o <filename>] [--cluster] [-clustermethod S] [--sidechain] [--split] [-splitthreshold DEG] [--show] [--stg]


## 参数解释
    -h      查看帮助
    -n      当前多肽构象系综所含氨基酸的数目。
    -s      当前多肽的氨基酸序列，氨基酸用单个大写字母缩写表示。如“甘氨酸-丙氨酸”二肽缩写为“VA”。
    -e      构象能量截断。能量高于此值的构象将不被读取，并不参与后续计算。
    -ncfm   数量截断，即按能量从低到高选取固定数量的数据。当设置了能量截断后，如所得系综规模小于此参数则该参数无效。默认为无穷大。
    -i      .csv格式的多肽二面角数据文件路径。
    -o      聚类结果输出文件路径。默认为当前目录。文件名为输入文件后加上“_clusteropt”。
    --cluster       是否进行构象聚类算法。默认为不进行。
    -clustermethod  使用的构象聚类算法，有“birch”与“kmeans”两个选项，默认为“birch”
    --sidechain     聚类算法是否考虑侧链二面角。默认为不考虑。
    --split         是否划分主链二面角以对聚类结果进行修正，默认为进行。
    -splitthreshold 修正算法所用的划分阈值，默认为90°。
    --show          是否进行聚类结果可视化。默认为不进行。
    --stg           是否绘制态密度图，默认为不绘制。

## 输入文件格式
    .csv格式的二面角数据，在Excel中的格式应如下所示
    | 构象文件名 | 以空格分隔的构象二面角(°) | 构象能量(kcal/mol)|
    |-----------|-------------------------|------------------|
    |  12345.xyz|   -180.0 45.0 90.0 135.0|             0.000|
    |  54321.xyz|   120.0 120.0 90.0 -45.0|             1.234|

### .csv文档格式
    构象文件名,以空格分隔的构象二面角(°),构象能量(kcal/mol)
    12345.xyz,-180.0 45.0 90.0 135.0,0.000
    54321.xyz,120.0 120.0 90.0 -45.0,1.234